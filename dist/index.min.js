!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).CRender={})}(this,(function(t){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,r)};function r(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n,o,i=function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;n>r;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function a(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function s(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&o[3]>i[1])){a.label=i[1];break}if(6===i[0]&&o[1]>a.label){a.label=o[1],o=i;break}if(o&&o[2]>a.label){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function u(){for(var t=0,e=0,r=arguments.length;r>e;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;r>e;e++)for(var i=arguments[e],a=0,s=i.length;s>a;a++,o++)n[o]=i[a];return n}function f(t,e){if(void 0===e&&(e=new Map([])),null===t||"object"!=typeof t)return t;if(e.has(t))return e.get(t);var r=Array.isArray(t)?[]:{};return e.set(t,r),Object.keys(t).forEach((function(n){return r[n]=f(t[n],e)})),r}!function(t){t.STATIC="STATIC",t.HOVER="HOVER",t.ACTIVE="ACTIVE",t.DRAG="DRAG"}(n||(n={})),function(t){t.transparent="rgba(0,0,0,0)",t.black="#000000",t.silver="#C0C0C0",t.gray="#808080",t.white="#FFFFFF",t.maroon="#800000",t.red="#FF0000",t.purple="#800080",t.fuchsia="#FF00FF",t.green="#008000",t.lime="#00FF00",t.olive="#808000",t.yellow="#FFFF00",t.navy="#000080",t.blue="#0000FF",t.teal="#008080",t.aqua="#00FFFF",t.aliceblue="#f0f8ff",t.antiquewhite="#faebd7",t.aquamarine="#7fffd4",t.azure="#f0ffff",t.beige="#f5f5dc",t.bisque="#ffe4c4",t.blanchedalmond="#ffebcd",t.blueviolet="#8a2be2",t.brown="#a52a2a",t.burlywood="#deb887",t.cadetblue="#5f9ea0",t.chartreuse="#7fff00",t.chocolate="#d2691e",t.coral="#ff7f50",t.cornflowerblue="#6495ed",t.cornsilk="#fff8dc",t.crimson="#dc143c",t.cyan="#00ffff",t.darkblue="#00008b",t.darkcyan="#008b8b",t.darkgoldenrod="#b8860b",t.darkgray="#a9a9a9",t.darkgreen="#006400",t.darkgrey="#a9a9a9",t.darkkhaki="#bdb76b",t.darkmagenta="#8b008b",t.darkolivegreen="#556b2f",t.darkorange="#ff8c00",t.darkorchid="#9932cc",t.darkred="#8b0000",t.darksalmon="#e9967a",t.darkseagreen="#8fbc8f",t.darkslateblue="#483d8b",t.darkslategray="#2f4f4f",t.darkslategrey="#2f4f4f",t.darkturquoise="#00ced1",t.darkviolet="#9400d3",t.deeppink="#ff1493",t.deepskyblue="#00bfff",t.dimgray="#696969",t.dimgrey="#696969",t.dodgerblue="#1e90ff",t.firebrick="#b22222",t.floralwhite="#fffaf0",t.forestgreen="#228b22",t.gainsboro="#dcdcdc",t.ghostwhite="#f8f8ff",t.gold="#ffd700",t.goldenrod="#daa520",t.greenyellow="#adff2f",t.grey="#808080",t.honeydew="#f0fff0",t.hotpink="#ff69b4",t.indianred="#cd5c5c",t.indigo="#4b0082",t.ivory="#fffff0",t.khaki="#f0e68c",t.lavender="#e6e6fa",t.lavenderblush="#fff0f5",t.lawngreen="#7cfc00",t.lemonchiffon="#fffacd",t.lightblue="#add8e6",t.lightcoral="#f08080",t.lightcyan="#e0ffff",t.lightgoldenrodyellow="#fafad2",t.lightgray="#d3d3d3",t.lightgreen="#90ee90",t.lightgrey="#d3d3d3",t.lightpink="#ffb6c1",t.lightsalmon="#ffa07a",t.lightseagreen="#20b2aa",t.lightskyblue="#87cefa",t.lightslategray="#778899",t.lightslategrey="#778899",t.lightsteelblue="#b0c4de",t.lightyellow="#ffffe0",t.limegreen="#32cd32",t.linen="#faf0e6",t.magenta="#ff00ff",t.mediumaquamarine="#66cdaa",t.mediumblue="#0000cd",t.mediumorchid="#ba55d3",t.mediumpurple="#9370db",t.mediumseagreen="#3cb371",t.mediumslateblue="#7b68ee",t.mediumspringgreen="#00fa9a",t.mediumturquoise="#48d1cc",t.mediumvioletred="#c71585",t.midnightblue="#191970",t.mintcream="#f5fffa",t.mistyrose="#ffe4e1",t.moccasin="#ffe4b5",t.navajowhite="#ffdead",t.oldlace="#fdf5e6",t.olivedrab="#6b8e23",t.orange="#ffa500",t.orangered="#ff4500",t.orchid="#da70d6",t.palegoldenrod="#eee8aa",t.palegreen="#98fb98",t.paleturquoise="#afeeee",t.palevioletred="#db7093",t.papayawhip="#ffefd5",t.peachpuff="#ffdab9",t.peru="#cd853f",t.pink="#ffc0cb",t.plum="#dda0dd",t.powderblue="#b0e0e6",t.rosybrown="#bc8f8f",t.royalblue="#4169e1",t.saddlebrown="#8b4513",t.salmon="#fa8072",t.sandybrown="#f4a460",t.seagreen="#2e8b57",t.seashell="#fff5ee",t.sienna="#a0522d",t.skyblue="#87ceeb",t.slateblue="#6a5acd",t.slategray="#708090",t.snow="#fffafa",t.springgreen="#00ff7f",t.steelblue="#4682b4",t.tan="#d2b48c",t.thistle="#d8bfd8",t.tomato="#ff6347",t.turquoise="#40e0d0",t.violet="#ee82ee",t.wheat="#f5deb3",t.whitesmoke="#f5f5f5",t.yellowgreen="#9acd32"}(o||(o={}));var h=o;function c(t){return"string"==typeof t&&(t=t.toLowerCase(),/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t))}function l(t){if(c(t)||function(t){return/^(rgb|rgba|RGB|RGBA)/.test(t)}(t))return t;var e=h[t];if(!e)throw Error("Color: Invalid Input of "+t);return e}function p(t){var e=l(t).toLowerCase();return c(e)?function(t){3===(t=t.replace("#","")).length&&(t=Array.from(t).map((function(t){return t+t})).join(""));var e=t.split("");return[,,,].fill(0).map((function(t,r){return parseInt("0x"+e[2*r]+e[2*r+1])}))}(e):function(t){return t.replace(/rgb\(|rgba\(|\)/g,"").split(",").slice(0,3).map((function(t){return parseInt(t)}))}(e)}function d(t){var e=l(t);return function(t){return"string"==typeof t&&(t=t.toLowerCase(),/^(rgba|RGBA)/.test(t))}(e)?Number(e.toLowerCase().split(",").slice(-1)[0].replace(/[)|\s]/g,"")):1}function v(t){var e=p(t);return e&&
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function(){for(var t=0,e=0,r=arguments.length;r>e;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;r>e;e++)for(var i=arguments[e],a=0,s=i.length;s>a;a++,o++)n[o]=i[a];return n}(e,[d(t)])}function y(t){if(!Array.isArray(t))throw Error("getColorFromRgbValue: "+t+" is not an array");var e=t.length;if(3!==e&&4!==e)throw Error("getColorFromRgbValue: value length should be 3 or 4");return(3===e?"rgb(":"rgba(")+t.join(",")+")"}function m(t){return function(t){var e=u(t);return y(e)}}var g=function(){function t(t){this.fill=[0,0,0,1],this.stroke=[0,0,0,0],this.opacity=1,this.lineCap="butt",this.lineJoin="miter",this.lineDash=[],this.lineDashOffset=0,this.shadowBlur=0,this.shadowColor=[0,0,0,0],this.shadowOffsetX=0,this.shadowOffsetY=0,this.lineWidth=1,this.hoverCursor="pointer",this.fontStyle="normal",this.fontVarient="normal",this.fontWeight="normal",this.fontSize=10,this.fontFamily="Arial",this.textAlign="center",this.textBaseline="middle",this.gradientType="linear",this.gradientWith="stroke",this.gradientStops="auto",t&&this.update(t)}return t.prototype.update=function(e){Object.assign(this,t.colorProcessor(e))},t.colorProcessor=function(t,e){var r=i({},t),n=function(t){return function(e){var r="string"==typeof e,n=Array.isArray(e);if(r&&t)return e;if(n&&!t)return u(e);if(r&&!t)return v(e);if(n&&t)return y(e);throw Error("CRender Style transformColor: Unexpected color!")}}(e);return r.fill&&(r.fill=n(r.fill)),r.stroke&&(r.stroke=n(r.stroke)),r.shadowColor&&(r.shadowColor=n(r.shadowColor)),r.gradientColor=(r.gradientColor||[]).map(n),r},t.prototype.setCtx=function(e,r){t.setCtxTransform(e,this,r),t.setCtxStyle(e,this),t.setCtxGradientColor(e,this)},t.setCtxTransform=function(t,e,r){t.save();var n=e.graphCenter,o=e.rotate,i=e.scale,a=e.translate;n instanceof Array&&(t.translate.apply(t,n),o&&t.rotate(o*Math.PI/180),i instanceof Array?t.scale.apply(t,i.map((function(t){return t*r}))):1!==r&&t.scale(r,r),a&&t.translate.apply(t,a),t.translate(-n[0],-n[1]))},t.setCtxStyle=function(t,e){t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.lineDashOffset=e.lineDashOffset,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY,t.lineWidth=e.lineWidth,t.textAlign=e.textAlign,t.textBaseline=e.textBaseline;var r=e.fill,n=e.stroke,o=e.shadowColor,i=m();t.fillStyle=i(r),t.strokeStyle=i(n),t.shadowColor=i(o);var a=e.lineDash,s=e.shadowBlur;a&&t.setLineDash(a.map((function(t){return 0>t?0:t}))),"number"==typeof s&&(t.shadowBlur=s>0?s:.001),t.font=e.fontStyle+" "+e.fontVarient+" "+e.fontWeight+" "+e.fontSize+"px "+e.fontFamily},t.setCtxGradientColor=function(t,e){if(function(t){var e=t.gradientColor,r=t.gradientParams,n=t.gradientType,o=t.gradientWith,i=t.gradientStops;if(!e||!r)return!1;if(1===e.length)return console.warn("CRender Style: The gradient needs to provide at least two colors"),!1;if("linear"!==n&&"radial"!==n)return console.warn("CRender Style: GradientType only supports linear or radial, current value is "+n),!1;var a=r.length;return"linear"===n&&4!==a||"radial"===n&&6!==a?(console.warn("CRender Style: The expected length of gradientParams is "+("linear"===n?"4":"6")),!1):"fill"!==o&&"stroke"!==o?(console.warn("CRender Style: GradientWith only supports fill or stroke, current value is "+o),!1):"auto"===i||i instanceof Array||(console.warn("CRender Style: gradientStops only supports 'auto' or Number Array ([0, .5, 1]), current value is "+i),!1)}(e)){var r,n,o,i=e.gradientColor,a=e.gradientParams,s=e.gradientType,u=e.gradientWith,f=e.gradientStops,h=m(),c=i.map(h),l="auto"===f?(n=1/((r=c).length-1),r.map((function(t,e){return n*e}))):f;o="linear"===s?t.createLinearGradient.apply(t,a):t.createRadialGradient.apply(t,a),l.forEach((function(t,e){return o.addColorStop(t,c[e])})),t["fill"===u?"fillStyle":"strokeStyle"]=o}},t.prototype.restoreCtx=function(t){t.restore()},t}();function b(t,e,r,n,o){var i=t[0],a=t[1];return i>=e&&(a>=r&&(e+n>=i&&a<=r+o))}var w=new Map([]);function C(t,e){var r=function(t,e){for(var r,n,o=t.length,i=o-1,a=0;o>a;a++){if(a!==i)if(n=t[a+1],e>=(r=t[a])[0][0]&&n[0][0]>e)break}return[r[0],r[2]||r[0],n[1]||n[0],n[0]]}(t,e);return function(t,e){var r=t[1][1],n=t[2][1],o=t[3][1],i=1-e;return 1-(t[0][1]*Math.pow(i,3)+3*r*e*Math.pow(i,2)+3*n*Math.pow(e,2)*i+o*Math.pow(e,3))}(r,function(t,e){var r=t[0][0];return(e-r)/(t[3][0]-r)}(r,e))}function x(t,e){var r;r="string"==typeof t?w.get(t):t;var n=1/(e-1);return Array(e).fill(0).map((function(t,e){return e*n})).map((function(t){return C(r,t)}))}var A=function(t,e,r,n){return(t/=n)<1/2.75?r*(7.5625*t*t)+e:2/2.75>t?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e},k=function(t,e,r,n){return r-A(n-t,0,r,n)+e},P=new Map([["linear",function(t,e,r,n){return r*t/n+e}],["easeInSine",function(t,e,r,n){return-r*Math.cos(t/n*(Math.PI/2))+r+e}],["easeOutSine",function(t,e,r,n){return r*Math.sin(t/n*(Math.PI/2))+e}],["easeInOutSine",function(t,e,r,n){return-r/2*(Math.cos(Math.PI*t/n)-1)+e}],["easeInQuad",function(t,e,r,n){return r*(t/=n)*t+e}],["easeOutQuad",function(t,e,r,n){return-r*(t/=n)*(t-2)+e}],["easeInOutQuad",function(t,e,r,n){return 1>(t/=n/2)?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e}],["easeInCubic",function(t,e,r,n){return r*(t/=n)*t*t+e}],["easeOutCubic",function(t,e,r,n){return r*((t=t/n-1)*t*t+1)+e}],["easeInOutCubic",function(t,e,r,n){return 1>(t/=n/2)?r/2*t*t*t+e:r/2*((t-=2)*t*t+2)+e}],["easeInQuart",function(t,e,r,n){return r*(t/=n)*t*t*t+e}],["easeOutQuart",function(t,e,r,n){return-r*((t=t/n-1)*t*t*t-1)+e}],["easeInOutQuart",function(t,e,r,n){return 1>(t/=n/2)?r/2*t*t*t*t+e:-r/2*((t-=2)*t*t*t-2)+e}],["easeInQuint",function(t,e,r,n){return r*(t/=n)*t*t*t*t+e}],["easeOutQuint",function(t,e,r,n){return r*((t=t/n-1)*t*t*t*t+1)+e}],["easeInOutQuint",function(t,e,r,n){return 1>(t/=n/2)?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e}],["easeInBack",function(t,e,r,n){var o=1.70158;return r*(t/=n)*t*((o+1)*t-o)+e}],["easeOutBack",function(t,e,r,n){var o=1.70158;return r*((t=t/n-1)*t*((o+1)*t+o)+1)+e}],["easeInOutBack",function(t,e,r,n){var o=1.70158;return 1>(t/=n/2)?r/2*(t*t*((1+(o*=1.525))*t-o))+e:r/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+e}],["easeInElastic",function(t,e,r,n){return 0===t?e:1==(t/=n)?e+r:-r*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t*n-.3*n/4)/(.3*n))+e}],["easeOutElastic",function(t,e,r,n){return 0===t?e:1==(t/=n)?e+r:r*Math.pow(2,-10*t)*Math.sin(2*Math.PI*(t*n-.3*n/4)/(.3*n))+r+e}],["easeInOutElastic",function(t,e,r,n){if(0===t)return e;if(2==(t/=n/2))return e+r;var o=n*(.3*1.5),i=o/4;return 1>t?r*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t*n-i)/o)*-.5+e:r*Math.pow(2,-10*(t-=1))*Math.sin(2*Math.PI*(t*n-i)/o)*.5+r+e}],["easeInBounce",k],["easeOutBounce",A],["easeInOutBounce",function(t,e,r,n){return n/2>t?.5*k(2*t,0,r,n)+e:.5*A(2*t-n,0,r,n)+.5*r+e}]]);function M(t,e){void 0===e&&(e=30);var r=e/(e-1),n=P.get(t);return Array(e).fill(0).map((function(t,o){return n(o*r,0,1,e)}))}function E(t){var e=t instanceof Array,r=w.has(t),n=P.has(t);if(e)return"transitionCurve";if(r)return"transitionCurveName";if(n)return"tween";throw Error("Transition: Invalid ease curve of "+t)}function G(t){return Object.prototype.toString.call(t).replace(/\[object |\]/g,"").toLowerCase()}function O(t){return Number.isFinite(t)}function S(t){var e=G(t);return"array"===e||"object"===e}function I(t,e){return Array(e).fill(0).map((function(e){return t}))}function R(t,e,r){return t.forEach((function(t,n){return t[r]=e[n]})),t}function T(t){return t?[]:{}}function D(t,e,r){var n=e-t;return r.map((function(e){return t+n*e}))}function F(t,e,r,n,o){if(void 0===n&&(n=30),void 0===o&&(o=!1),function(t,e,r,n){var o=[t,e,r,n].map(G);if(o.find((function(t){return"undefined"===t})))throw Error("transition: Missing Parameters!");if(o[1]!==o[2])throw Error("transition: The start state type and the end state type are inconsistent!");if("number"!==o[3]||0>=n)throw Error("Transition: frameNum should be a number and greater than 1");E(t)}(t,e,r,n),!function(t){var e=G(t);return["number","array","object"].includes(e)}(e))return console.warn("Transition: Only supports array number and object types"),[e,r];try{return function t(e,r,n,o){var i=G(e),a=n.length;if("number"===i)return D(e,r,n);var s="array"===i,u=Array(a).fill(s).map(T);for(var f in r){var h=e[f],c=r[f];u=R(u,O(h)&&O(c)?D(h,c,n):S(h)&&S(c)&&o?t(h,c,n,o):I(c,a),f)}return u}(e,r,function(t,e){return void 0===e&&(e=30),("tween"===E(t)?M:x)(t,e)}(t,n),o)}catch(t){return console.warn("Transition: parameter may be abnormal!"),[r]}}var j=function(){function t(t,e){this.visible=!0,this.drag=!1,this.hover=!1,this.index=1,this.animationDelay=0,this.animationFrame=30,this.animationCurve="linear",this.animationPause=!1,this.status=n.STATIC,this.animationQueue=[];var r=new g(t.style);Object.assign(this,t,{status:n.STATIC,animationRoot:[],animationKeys:[],animationFrameState:[],style:r,render:e}),this.setGraphCenter(),this.added&&this.added()}return t.prototype.draw=function(){},t.prototype.setGraphCenter=function(){},t.prototype.hoverCheck=function(t){return!1},t.prototype.move=function(t){},t.mergeDefaultShape=function(t,e,r){var n=i(i({},e),{shape:Object.assign(t,e.shape||{})});return r&&r(n),n},t.prototype.drawProcessor=function(){var t=this.render,e=t.ctx;this.style.setCtx(e,t.dpr),this.beforeDraw&&this.beforeDraw(),this.draw(),this.drawed&&this.drawed(),this.style.restoreCtx(e)},t.prototype.hoverCheckProcessor=function(t){var e=this.hoverRect,r=this.style,n=r.graphCenter,o=r.rotate,i=r.scale,a=r.translate;return!!this.hoverCheck&&(n&&(o&&(t=function(t,e,r){if(void 0===t&&(t=0),void 0===r&&(r=[0,0]),t%360==0)return e;var n=e[0],o=e[1],i=r[0],a=r[1];return[(n-i)*Math.cos(t*=Math.PI/180)-(o-a)*Math.sin(t)+i,(n-i)*Math.sin(t)+(o-a)*Math.cos(t)+a]}(-o,t,n)),i&&(t=function(t,e,r){void 0===t&&(t=[1,1]),void 0===r&&(r=[0,0]);var n=r[0],o=r[1];return[(e[0]-n)*t[0]+n,(e[1]-o)*t[1]+o]}(i.map((function(t){return 1/t})),t,n)),a&&(t=function(t,e){return[e[0]+t[0],e[1]+t[1]]}(a.map((function(t){return-1*t})),t))),e?b.apply(void 0,u([t],e)):this.hoverCheck(t))},t.prototype.moveProcessor=function(t){this.move&&(this.beforeMove&&this.beforeMove(t),this.move(t),this.moved&&this.moved(t),this.setGraphCenter())},t.prototype.attr=function(t,e,r){void 0===r&&(r=!0);var n="object"==typeof this[t];n&&(e=f(e));var o=this.render;"style"===t?this.style.update(e):n?Object.assign(this[t],e):this[t]=e,"index"===t&&o.sortGraphsByIndex(),r&&o.drawAllGraph()},t.prototype.animation=function(t,e,r){return void 0===r&&(r=!1),a(this,void 0,void 0,(function(){var n,o,u,h,c,l,p=this;return s(this,(function(d){switch(d.label){case 0:return"shape"!==t&&"style"!==t?(console.error("Graph animation: Only supported shape and style animation!"),[2]):"object"!=typeof e?(console.error("Graph animation: Shape or style must be an object!"),[2]):(e=f(e),"style"===t&&(e=g.colorProcessor(e)),n=this[t],o=Object.keys(e).reduce((function(t,e){var r;return i(i({},t),((r={})[e]=n[e],r))}),Object.create(null)),h=(u=this).animationDelay,c=F(u.animationCurve,o,e,u.animationFrame,!0),this.animationQueue.push({key:t,frameState:c}),r?[2]:h>0?[4,(v=h,new Promise((function(t){setTimeout(t,v)})))]:[3,2]);case 1:d.sent(),d.label=2;case 2:return l=this.render,[2,new Promise((function(t){return a(p,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,l.launchAnimation()];case 1:return e.sent(),t(),[2]}}))}))}))]}var v}))}))},t.prototype.turnNextAnimationFrame=function(t){var e=this,r=this.animationDelay,n=this.animationQueue;this.animationPause||Date.now()-t<r||(this.animationQueue=n.reduce((function(t,r){var n=r.key,o=r.frameState;return Object.assign(e[n],o.shift()),o.length?u(t,[{key:n,frameState:o}]):t}),[]))},t.prototype.animationEnd=function(){var t=this,e=this.render;return this.animationQueue.forEach((function(e){return Object.assign(t[e.key],e.frameState.pop())})),this.animationQueue=[],e.drawAllGraph()},t.prototype.pauseAnimation=function(){this.attr("animationPause",!0)},t.prototype.playAnimation=function(){var t=this,e=this.render;return this.attr("animationPause",!1),new Promise((function(r){return a(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.launchAnimation()];case 1:return t.sent(),r(),[2]}}))}))}))},t.prototype.delProcessor=function(){var t=this,e=this.render.graphs,r=e.findIndex((function(e){return e===t}));-1!==r&&(this.beforeDelete&&this.beforeDelete(),e.splice(r,1),this.deleted&&this.deleted())},t}();function W(t,e){var r=t[1],n=e[1],o=Math.abs(t[0]-e[0]),i=Math.abs(r-n);return Math.sqrt(o*o+i*i)}function B(t,e){return-t[1]*e[0]+t[0]*e[1]>0}function z(t,e,r,n){return[t+Math.cos(n)*r,e+Math.sin(n)*r]}function V(t,e){var r,n,o,i=e.rx,a=e.ry,s=e.r,u=e.startAngle,f=e.endAngle,h=e.clockWise;if(!t)return!1;if(W(t,[i,a])>s)return!1;h||(u=(r=[f,u])[0],f=r[1]);var c=u>f;c&&(u=(n=[f,u])[0],f=n[1]);var l=f-u;if(l>=2*Math.PI)return!0;var p=t[0],d=t[1],v=z(i,a,s,u),y=v[0],m=v[1],g=z(i,a,s,f),b=[p-i,d-a],w=[y-i,m-a],C=[g[0]-i,g[1]-a],x=l>Math.PI;x&&(w=(o=[C,w])[0],C=o[1]);var A=B(w,b)&&!B(C,b);return x&&(A=!A),c&&(A=!A),A}function Q(t,e){for(var r=0,n=t[0],o=t[1],i=e.length,a=1,s=e[0];i>=a;a++){var u=e[a%i];if(n>Math.min(s[0],u[0])&&Math.max(s[0],u[0])>=n)if(Math.max(s[1],u[1])>=o)if(s[0]!==u[0])s[1]!==u[1]&&o>(n-s[0])*(u[1]-s[1])/(u[0]-s[0])+s[1]||r++;s=u}return r%2==1}function Y(t,e,r){var n=r/2;return Q(t,u(e.map((function(t){return[t[0],t[1]-n]})),e.map((function(t){return[t[0],t[1]+n]})).reverse()))}var X=function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({rx:0,ry:0,r:0,startAngle:0,endAngle:0,clockWise:!0},e,(function(t){var e=t.shape;if(["rx","ry","r","startAngle","endAngle"].find((function(t){return"number"!=typeof e[t]})))throw Error("CRender Graph Arc: Arc shape configuration is invalid!")})),r)||this;return n.name="arc",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.render.ctx,r=t.rx,n=t.ry,o=t.r,i=t.startAngle,a=t.endAngle,s=t.clockWise;e.beginPath(),e.arc(r,n,o>0?o:0,i,a,!s),e.stroke()},e.prototype.hoverCheck=function(t){var e=this.shape,r=e.rx,n=e.ry,o=e.r,i=e.startAngle,a=e.endAngle,s=e.clockWise,u=this.style.lineWidth/2,f=o+u,h=V(t,{rx:r,ry:n,r:o-u,startAngle:i,endAngle:a,clockWise:s}),c=V(t,{rx:r,ry:n,r:f,startAngle:i,endAngle:a,clockWise:s});return!h&&c},e.prototype.setGraphCenter=function(){var t=this.shape;this.style.graphCenter=[t.rx,t.ry]},e.prototype.move=function(t){var e=this.shape;this.attr("shape",{rx:e.rx+t.movementX,ry:e.ry+t.movementY})},e}(j);function L(t,e,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1),2>e.length||(r&&t.beginPath(),e.forEach((function(e,r){return e&&(0===r?t.moveTo.apply(t,e):t.lineTo.apply(t,e))})),n&&t.closePath())}function q(t,e,r,n,o){void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),t&&e&&(n&&t.beginPath(),r&&t.moveTo.apply(t,r),e.forEach((function(e){return t.bezierCurveTo(e[0][0],e[0][1],e[1][0],e[1][1],e[2][0],e[2][1])})),o&&t.closePath())}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function _(){for(var t=0,e=0,r=arguments.length;r>e;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;r>e;e++)for(var i=arguments[e],a=0,s=i.length;s>a;a++,o++)n[o]=i[a];return n}function H(t){return t.reduce((function(t,e){return t+e}),0)}function N(t){return t.reduce((function(t,e){return _(t,e)}),[])}function J(t,e,r,n){var o=new Map([]);return function(i){if(o.has(i))return o.get(i);var a=1-i,s=Math.pow(a,3),u=Math.pow(a,2),f=Math.pow(i,3),h=Math.pow(i,2),c=[t[0]*s+3*e[0]*i*u+3*r[0]*h*a+n[0]*f,t[1]*s+3*e[1]*i*u+3*r[1]*h*a+n[1]*f];return o.set(i,c),c}}function U(t){var e=function(t){return t.slice(1)}(t),r=function(t){return t[0]}(t);return e.map((function(t,n){return J.apply(void 0,_([0===n?r:e[n-1][2]],t))}))}function K(t,e){return t.map((function(t,r){var n=1/(e[r]-1);return Array(e[r]).fill(0).map((function(e,r){return t(r*n)}))}))}function $(t){return Array(t.length-1).fill(0).map((function(e,r){return i=(n=t[r])[1],a=(o=t[r+1])[1],Math.sqrt(Math.pow(n[0]-o[0],2)+Math.pow(i-a,2));var n,o,i,a}))}function Z(t){var e=function(t){return t.map($)}(t),r=H(e.map((function(t){return t.length}))),n=e.map(H),o=H(n),i=o/r;return{totalLength:o,segmentLength:n,avgDistance:i,deviation:function(t,e){return H(t.map((function(t){return t.map((function(t){return Math.abs(t-e)}))})).map(H))}(e,i)}}function tt(t){return N(t).length}function et(t,e,r,n){console.warn("-------------start-------------");var o=Z(t);return o.deviation>r?(t=function(t,e,r,n){var o=r.avgDistance,i=r.totalLength,a=r.segmentLength,s=tt(t);return s=Math.ceil(o/n*s*1.1),K(e,a.map((function(t){return Math.ceil(t/i*s)})).map((function(t){return t>1?t:2})))}(t,e,o,r),N(n>0?t=function(t,e,r,n){var o=r.avgDistance,i=1/tt(t)/10;return e.forEach((function(e,r){for(var a=t[r].length,s=1/(a-1),u=Array(a).fill(0).map((function(t,e){return e*s})),f=0;n>f;f++)for(var h=$(t[r]).map((function(t){return t-o})),c=0,l=0;a>l;l++)0!==l&&(u[l]-=i*(c+=h[l-1]),u[l]>1&&(u[l]=1),0>u[l]&&(u[l]=0),t[r][l]=e(u[l]))})),t}(t,e,o=Z(t),n):t)):N(t)}function rt(t,e,r){void 0===e&&(e=5),void 0===r&&(r=0);var n=U(t),o=et(function(t){return K(t,Array(t.length).fill(50))}(n),n,e,r),i=function(t){return t.slice(-1)[0][2]}(t);return o.push(i),o}function nt(t,e,r){if(void 0===e&&(e=5),void 0===r&&(r=0),!(t instanceof Array))throw Error("bezierCurveToPolyline: Invalid input of "+t);if(1>=t.length)throw Error("bezierCurveToPolyline: The length of the bezierCurve should be greater than 1");if("number"!=typeof e)throw Error("bezierCurveToPolyline: Type of precision must be number");return rt(t,e,r)}function ot(t,e){var r=e[0],n=e[1];return[r+(r-t[0]),n+(n-t[1])]}function it(t,e,r,n){if(void 0===e&&(e=!1),void 0===r&&(r=.25),void 0===n&&(n=.25),!(t instanceof Array))throw Error("polylineToBezierCurve: Invalid input of "+t);if(2>=t.length)throw Error("polylineToBezierCurve: The length of the polyline should be greater than 2");var o=t[0],i=Array(t.length-1).fill(0).map((function(o,i){return _(function(t,e,r,n,o){void 0===r&&(r=!1),void 0===n&&(n=.25),void 0===o&&(o=.25);var i=t.length;if(3>i||e>=i)return null;var a=e-1;0>a&&(a=r?i+a:0);var s=e+1;i>s||(s=r?s-i:i-1);var u=e+2;i>u||(u=r?u-i:i-1);var f=t[a],h=t[e],c=t[s],l=t[u];return[[h[0]+n*(c[0]-f[0]),h[1]+n*(c[1]-f[1])],[c[0]-o*(l[0]-h[0]),c[1]-o*(l[1]-h[1])]]}(t,i,e,r,n),[t[i+1]])}));return e&&function(t,e){var r=t[0],n=t.slice(-1)[0];t.push([ot(n[1],n[2]),ot(r[0],e),e])}(i,o),i.unshift(t[0]),i}var at={arc:X,bezierCurve:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({points:[],close:!1},e,(function(t){if(!(t.shape.points instanceof Array))throw Error("CRender Graph BezierCurve: BezierCurve points should be an array!")})),r)||this;return n.name="bezierCurve",n.cache={},n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.cache,r=t.points,n=t.close,o=this.render.ctx;if(!e.points||""+e.points!=""+r){var i=nt(r,20);Object.assign(e,{points:f(r),hoverPoints:i})}o.beginPath(),q(o,r.slice(1),r[0]),n?(o.closePath(),o.fill(),o.stroke()):o.stroke()},e.prototype.hoverCheck=function(t){var e=this.cache.hoverPoints,r=this.style.lineWidth;return this.shape.close?Q(t,e):Y(t,e,r)},e.prototype.setGraphCenter=function(){this.style.graphCenter=this.shape.points[0]},e.prototype.move=function(t){var e=t.movementX,r=t.movementY,n=this.shape.points,o=this.cache,i=n[0],a=i[0],s=i[1],f=n.slice(1),h=u([[a+e,s+r]],f.map((function(t){return t.map((function(t){return[t[0]+e,t[1]+r]}))})));o.points=h,o.hoverPoints=o.hoverPoints.map((function(t){return[t[0]+e,t[1]+r]})),this.attr("shape",{points:h})},e}(j),circle:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({rx:0,ry:0,r:0},e,(function(t){var e=t.shape;if("number"!=typeof e.rx||"number"!=typeof e.ry||"number"!=typeof e.r)throw Error("CRender Graph Circle: Circle shape configuration is invalid!")})),r)||this;return n.name="circle",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.render.ctx,r=t.rx,n=t.ry,o=t.r;e.beginPath(),e.arc(r,n,o>0?o:0,0,2*Math.PI),e.fill(),e.stroke()},e.prototype.hoverCheck=function(t){return function(t,e){var r=e.r;return W(t,[e.rx,e.ry])<=r}(t,this.shape)},e.prototype.setGraphCenter=function(){var t=this.shape;this.style.graphCenter=[t.rx,t.ry]},e.prototype.move=function(t){var e=this.shape;this.attr("shape",{rx:e.rx+t.movementX,ry:e.ry+t.movementY})},e}(j),ellipse:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({rx:0,ry:0,hr:0,vr:0},e,(function(t){var e=t.shape;if("number"!=typeof e.rx||"number"!=typeof e.ry||"number"!=typeof e.hr||"number"!=typeof e.vr)throw Error("CRender Graph Ellipse: Ellipse shape configuration is invalid!")})),r)||this;return n.name="ellipse",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.render.ctx,r=t.rx,n=t.ry,o=t.hr,i=t.vr;e.beginPath(),e.ellipse(r,n,o>0?o:0,i>0?i:0,0,0,2*Math.PI),e.fill(),e.stroke()},e.prototype.hoverCheck=function(t){var e=this.shape,r=e.rx,n=e.ry,o=e.hr,i=e.vr,a=Math.max(o,i),s=Math.min(o,i),u=Math.sqrt(a*a-s*s),f=[r+u,n];return 2*a>=W(t,[r-u,n])+W(t,f)},e.prototype.setGraphCenter=function(){var t=this.shape;this.style.graphCenter=[t.rx,t.ry]},e.prototype.move=function(t){var e=this.shape;this.attr("shape",{rx:e.rx+t.movementX,ry:e.ry+t.movementY})},e}(j),polyline:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({points:[],close:!1},e,(function(t){if(!(t.shape.points instanceof Array))throw Error("CRender Graph Polyline: Polyline points should be an array!")})),r)||this;return n.name="polyline",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.style.lineWidth,r=this.render.ctx,n=t.points,o=t.close;r.beginPath(),L(r,1===e?function(t){return t.map((function(t){return[.5+(0|t[0]),.5+(0|t[1])]}))}(n):n),o?(r.closePath(),r.fill(),r.stroke()):r.stroke()},e.prototype.hoverCheck=function(t){var e=this.shape,r=e.points,n=this.style.lineWidth;return e.close?Q(t,r):Y(t,r,n)},e.prototype.setGraphCenter=function(){this.style.graphCenter=this.shape.points[0]},e.prototype.move=function(t){var e=t.movementX,r=t.movementY,n=this.shape.points.map((function(t){return[t[0]+e,t[1]+r]}));this.attr("shape",{points:n})},e}(j),rect:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({x:0,y:0,w:0,h:0},e,(function(t){var e=t.shape;if("number"!=typeof e.x||"number"!=typeof e.y||"number"!=typeof e.w||"number"!=typeof e.h)throw Error("CRender Graph Rect: Rect shape configuration is invalid!")})),r)||this;return n.name="rect",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.render.ctx,r=t.x,n=t.y,o=t.w,i=t.h;e.beginPath(),e.rect(r,n,o,i),e.fill(),e.stroke()},e.prototype.hoverCheck=function(t){var e,r,n,o,i,a;return o=(e=t)[1],a=(r=this.shape).y,!((i=r.x)>(n=e[0])||a>o||n>i+r.w||o>a+r.h)},e.prototype.setGraphCenter=function(){var t=this.shape;this.style.graphCenter=[t.x+t.w/2,t.y+t.h/2]},e.prototype.move=function(t){var e=this.shape;this.attr("shape",{x:e.x+t.movementX,y:e.y+t.movementY})},e}(j),regPolygon:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({rx:0,ry:0,r:0,side:0},e,(function(t){var e=t.shape,r=e.side;if(["rx","ry","r","side"].find((function(t){return"number"!=typeof e[t]})))throw Error("CRender Graph RegPolygon: RegPolygon shape configuration is invalid!");if(3>r)throw Error("CRender Graph RegPolygon: RegPolygon at least trigon!")})),r)||this;return n.name="regPolygon",n.cache={},n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.cache,r=this.render.ctx,n=t.rx,o=t.ry,i=t.r,a=t.side;if(e.points||e.rx!==n||e.ry!==o||e.r!==i||e.side!==a){var s=function(t,e){var r=t.rx,n=t.ry,o=t.r,i=t.side;void 0===e&&(e=-.5*Math.PI);var a=2*Math.PI/i;return Array(i).fill("").map((function(t,r){return r*a+e})).map((function(t){return z(r,n,o,t)}))}(t);Object.assign(e,{points:s,rx:n,ry:o,r:i,side:a})}var u=e.points;r.beginPath(),L(r,u),r.stroke(),r.fill()},e.prototype.hoverCheck=function(t){return Q(t,this.cache.points)},e.prototype.setGraphCenter=function(){var t=this.shape;this.style.graphCenter=[t.rx,t.ry]},e.prototype.move=function(t){var e=t.movementX,r=t.movementY,n=this.shape,o=this.cache,i=n.rx,a=n.ry;o.rx+=e,o.ry+=r,this.attr("shape",{rx:i+e,ry:a+r}),o.points=o.points.map((function(t){return[t[0]+e,t[1]+r]}))},e}(j),ring:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({rx:0,ry:0,r:0},e,(function(t){var e=t.shape;if("number"!=typeof e.rx||"number"!=typeof e.ry||"number"!=typeof e.r)throw Error("CRender Graph Ring: Ring shape configuration is invalid!")})),r)||this;return n.name="ring",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.render.ctx,r=t.rx,n=t.ry,o=t.r;e.beginPath(),e.arc(r,n,o>0?o:0,0,2*Math.PI),e.stroke()},e.prototype.hoverCheck=function(t){var e=this.shape,r=e.r,n=this.style.lineWidth/2,o=r-n,i=r+n,a=W(t,[e.rx,e.ry]);return a>=o&&i>=a},e.prototype.setGraphCenter=function(){var t=this.shape;this.style.graphCenter=[t.rx,t.ry]},e.prototype.move=function(t){var e=this.shape;this.attr("shape",{rx:e.rx+t.movementX,ry:e.ry+t.movementY})},e}(j),sector:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({rx:0,ry:0,r:0,startAngle:0,endAngle:0,clockWise:!0},e,(function(t){var e=t.shape;if(["rx","ry","r","startAngle","endAngle"].find((function(t){return"number"!=typeof e[t]})))throw Error("CRender Graph Sector: Sector shape configuration is invalid!")})),r)||this;return n.name="sector",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.render.ctx,r=t.rx,n=t.ry,o=t.r,i=t.startAngle,a=t.endAngle,s=t.clockWise;e.beginPath(),e.arc(r,n,o>0?o:0,i,a,!s),e.lineTo(r,n),e.stroke(),e.fill()},e.prototype.hoverCheck=function(t){return V(t,this.shape)},e.prototype.setGraphCenter=function(){var t=this.shape;this.style.graphCenter=[t.rx,t.ry]},e.prototype.move=function(t){var e=this.shape;this.attr("shape",{rx:e.rx+t.movementX,ry:e.ry+t.movementY})},e}(j),smoothline:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({points:[],close:!1},e,(function(t){if(!(t.shape.points instanceof Array))throw Error("CRender Graph Smoothline: Smoothline points should be an array!")})),r)||this;return n.name="smoothline",n.cache={},n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.cache,r=this.render.ctx,n=t.points,o=t.close;if(!e.points||""+e.points!=""+n){var i=it(n,o),a=nt(i);Object.assign(e,{points:f(n),bezierCurve:i,hoverPoints:a})}var s=e.bezierCurve;r.beginPath(),q(r,s.slice(1),s[0]),o?(r.closePath(),r.fill(),r.stroke()):r.stroke()},e.prototype.hoverCheck=function(t){var e=this.cache.hoverPoints,r=this.style.lineWidth;return this.shape.close?Q(t,e):Y(t,e,r)},e.prototype.setGraphCenter=function(){this.style.graphCenter=this.shape.points[0]},e.prototype.move=function(t){var e=t.movementX,r=t.movementY,n=this.cache,o=this.shape.points.map((function(t){return[t[0]+e,t[1]+r]}));n.points=o;var i=n.bezierCurve[0],a=i[0],s=i[1],f=n.bezierCurve.slice(1);n.bezierCurve=u([[a+e,s+r]],f.map((function(t){return t.map((function(t){return[t[0]+e,t[1]+r]}))}))),n.hoverPoints=n.hoverPoints.map((function(t){return[t[0]+e,t[1]+r]})),this.attr("shape",{points:o})},e}(j),text:function(t){function e(e,r){var n=t.call(this,j.mergeDefaultShape({content:"",position:[0,0],maxWidth:void 0,rowGap:0},e,(function(t){var e=t.shape,r=e.position,n=e.rowGap;if("string"!=typeof e.content)throw Error("CRender Graph Text: Text content should be a string!");if(!Array.isArray(r))throw Error("CRender Graph Text: Text position should be an array!");if("number"!=typeof n)throw Error("CRender Graph Text: Text rowGap should be a number!")})),r)||this;return n.name="text",n}return r(e,t),e.prototype.draw=function(){var t=this.shape,e=this.render.ctx,r=t.position,n=t.maxWidth,o=t.rowGap,i=e.textBaseline,a=e.font,s=t.content.split("\n"),u=s.length,f=parseInt(a.replace(/\D/g,"")),h=f+o,c=u*h-o,l=0,p=r[0],d=r[1];"middle"===i&&(l=c/2,d+=f/2),"bottom"===i&&(l=c,d+=f);var v=Array(u).fill(0).map((function(t,e){return[p,d+e*h-l]}));e.beginPath(),s.forEach((function(t,r){e.fillText(t,v[r][0],v[r][1],n),e.strokeText(t,v[r][0],v[r][1],n)})),e.closePath()},e.prototype.setGraphCenter=function(){this.style.graphCenter=u(this.shape.position)},e.prototype.move=function(t){var e=this.shape.position;this.attr("shape",{position:[e[0]+t.movementX,e[1]+t.movementY]})},e}(j)},st=function(){function t(t,e){if(void 0===e&&(e=!1),this.dpr=1,this.offScreenRendering=!1,this.area=[0,0],this.animationStatus=!1,this.graphs=[],this.drawAllGraphDebounced=function(t,e){var r=this;void 0===e&&(e=0);var n=void 0;return function(){for(var o=[],i=0;arguments.length>i;i++)o[i]=arguments[i];n&&clearTimeout(n),n=setTimeout((function(){t.call.apply(t,u([r],o))}),e)}}(this.drawAllGraphImmediately.bind(this),0),!t)throw Error("CRender: Missing parameters!");var r=devicePixelRatio||1,n=t.getContext("2d"),o=t.clientWidth*r,i=t.clientHeight*r,a=[o,i];if(t.setAttribute("width",o+""),t.setAttribute("height",i+""),Object.assign(this,{dpr:r,area:a,canvas:t,ctx:n,actualCtx:n}),t.addEventListener("mousedown",this.mouseDown.bind(this)),t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("mouseup",this.mouseUp.bind(this)),OffscreenCanvas||!e){var s=new OffscreenCanvas(o,i),f=s.getContext("2d");Object.assign(this,{osCanvas:s,osCtx:f,offScreenRendering:e})}else console.warn("Your browser does not support off-screen rendering!")}return t.prototype.clearArea=function(){var t=this.osCanvas,e=this.area,r=this.offScreenRendering;this.canvas.width=e[0],r&&(t.width=e[0])},t.prototype.sortGraphsByIndex=function(){this.graphs.sort((function(t,e){return t.index-e.index}))},t.prototype.drawAllGraph=function(t){void 0===t&&(t=!1),t?this.drawAllGraphImmediately():this.drawAllGraphDebounced()},t.prototype.drawAllGraphImmediately=function(){var t=this.offScreenRendering,e=this.actualCtx,r=this.osCtx,n=this.osCanvas;this.clearArea(),this.ctx=t?r:e,this.graphs.filter((function(t){return t.visible})).forEach((function(t){return t.drawProcessor()})),t&&e.drawImage(n,0,0)},t.prototype.add=function(t,e){void 0===e&&(e=!1);var r=t.name;if(!r)throw Error("CRender add: Missing parameters!");var n=at[r];if(!n)throw Error("CRender add: Graph "+r+" has not been registered!");var o=new n(t,this);return this.addGraph(o,e),o},t.prototype.addGraph=function(t,e){this.graphs.push(t),this.sortGraphsByIndex(),e||this.drawAllGraph()},t.prototype.delGraph=function(t){t.delProcessor(),this.drawAllGraph()},t.prototype.delAllGraph=function(){this.graphs.forEach((function(t){return t.delProcessor()})),this.clearArea()},t.prototype.clone=function(t,e){void 0===e&&(e=!1);var r=f(i({},t));return this.add(r,e)},t.prototype.launchAnimation=function(){var t=this;if(!this.animationStatus)return this.animationStatus=!0,new Promise((function(e){t.animate((function(){t.animationStatus=!1,e()}),Date.now())}))},t.prototype.animate=function(t,e){var r=this.graphs;this.animateAble()?(r.forEach((function(t){return t.turnNextAnimationFrame(e)})),this.drawAllGraph(),requestAnimationFrame(this.animate.bind(this,t,e))):t()},t.prototype.animateAble=function(){return!!this.graphs.find((function(t){return!t.animationPause&&t.animationQueue.length}))},t.prototype.mouseDown=function(){var t=this.graphs.find((function(t){return t.status===n.HOVER}));t&&(t.status=n.ACTIVE)},t.prototype.mouseMove=function(t){var e=[t.offsetX,t.offsetY],r=this.graphs,o=r.find((function(t){return t.status===n.ACTIVE||t.status===n.DRAG}));if(o&&o.drag&&o.move)return o.moveProcessor(t),void(o.status=n.DRAG);var i=r.find((function(t){return t.status===n.HOVER})),a=r.filter((function(t){return t.hover&&(t.hoverCheck||t.hoverRect)})).find((function(t){return t.hoverCheckProcessor(e)}));if(document.body.style.cursor=a?a.style.hoverCursor:"default",(a||i)&&a!==i){if(!a&&i)return i.onMouseOuter&&i.onMouseOuter(t),void(i.status=n.STATIC);if(a&&!i)return a.onMouseEnter&&a.onMouseEnter(t),void(a.status=n.HOVER);i.onMouseOuter&&i.onMouseOuter(t),i.status=n.STATIC,a.onMouseEnter&&a.onMouseEnter(t),a.status=n.HOVER}},t.prototype.mouseUp=function(t){var e=this.graphs,r=e.find((function(t){return t.status===n.ACTIVE})),o=e.find((function(t){return t.status===n.DRAG}));r&&r.onClick&&r.onClick(t),e.forEach((function(t){return t.status=n.STATIC})),r&&(r.status=n.HOVER),o&&(o.status=n.HOVER)},t}();t.CRender=st,t.Graph=j,t.default=st,Object.defineProperty(t,"__esModule",{value:!0})}));
